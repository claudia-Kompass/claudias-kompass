<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>GLOBAL SOUL</title>

<style>
body {
  margin: 0;
  font-family: system-ui;
  background: linear-gradient(135deg,#0f1a2b,#16263f);
  color: #e8dcc0;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 40px 20px;
}

h1 {
  font-size: 40px;
  margin-bottom: 6px;
  letter-spacing: 2px;
  font-weight: 600;
  font-family: "Playfair Display", serif;
  color: #f3ead6;
}

.subtitle {
  font-size: 16px;
  opacity: 0.85;
  margin-bottom: 18px;
}

.claim-de {
  font-size: 17px;
  font-weight: 500;
  margin-bottom: 4px;
  color: #f3ead6;
}

.claim-en {
  font-size: 13px;
  font-style: italic;
  opacity: 0.55;
  margin-bottom: 22px;
}

.meta-info {
  font-size: 14px;
  opacity: 0.65;
  letter-spacing: 0.3px;
}

.meta-version {
  font-size: 12px;
  font-style: italic;
  margin-left: 6px;
}

h2 {
  font-size: 22px;
  margin-top: 50px;
  margin-bottom: 18px;
  border-bottom: 1px solid rgba(243,234,214,0.18);
  padding-bottom: 10px;
  color: #f3ead6;
}

.markets-line {
  font-size: 17px;
  font-weight: 500;
  margin: 6px 0;
  color: #e8dcc0;
}

.crypto-line {
  font-size: 18px;
  font-weight: 600;
  margin: 6px 0;
  color: white;
}

/* Ampel */
.ampel {
  display: inline-block;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  margin-right: 10px;
  box-shadow: 0 0 6px rgba(255,255,255,0.15);
}

.ampel.green { background:#2ecc71; box-shadow:0 0 10px rgba(46,204,113,0.6); }
.ampel.red { background:#e74c3c; box-shadow:0 0 10px rgba(231,76,60,0.6); }
.ampel.yellow { background:#f1c40f; box-shadow:0 0 10px rgba(241,196,15,0.6); }

.change-positive { color:#2ecc71; }
.change-negative { color:#e74c3c; }
.change-neutral { color:#f1c40f; }

.usd {
  opacity: 0.65;
  font-size: 16px;
  font-weight: 400;
}

.weather-location {
  font-size: 18px;
  font-weight: 500;
  color: rgba(232,220,192,0.85);
}

.weather-temp-main {
  font-size: 18px;
  font-weight: 500;
  color: #e8dcc0;
  margin: 4px 0;
}

.weather-condition {
  font-size: 13px;
  opacity: 0.6;
  margin-bottom: 18px;
}

.trend-grid {
  display: flex;
  gap: 32px;
  margin: 6px 0;
}

button {
  margin-top: 25px;
  padding: 12px 20px;
  background: #e8dcc0;
  border: none;
  cursor: pointer;
  font-weight: 600;
  border-radius: 6px;
  color: #0f1a2b;
}

.dot {
  display:inline-block;
  width:10px;
  height:10px;
  border-radius:50%;
  margin-right:6px;
}

.green { background:#4caf50; }
.red { background:#e53935; }
.yellow { background:#fbc02d; }

.weather-main {
  font-size:18px;
  margin-bottom:10px;
}

.trend div {
  margin-bottom:4px;
}

.mood {
  margin-top:20px;
  font-style:italic;
  opacity:0.7;
}
  
</style>
</head>

<body>
<div class="container">

<h1>üåç GLOBAL SOUL</h1>
<div class="subtitle">Claudia‚Äôs Daily Compass</div>

<div class="claim-de">Zwischen Heimat und Horizont.</div>
<div class="claim-en">between home and horizon</div>

<div id="metaInfo" class="meta-info"></div>
<div id="content"></div>

<button onclick="loadData()">Neue Ausgabe</button>

</div>

<script>

function getWeatherIcon(code){
  const map = {
    0: "‚òÄÔ∏è",
    1: "üå§Ô∏è",
    2: "‚õÖ",
    3: "‚òÅÔ∏è",
    45: "üå´Ô∏è",
    48: "üå´Ô∏è",
    51: "üå¶Ô∏è",
    61: "üåßÔ∏è",
    63: "üåßÔ∏è",
    71: "‚ùÑÔ∏è",
    73: "‚ùÑÔ∏è",
    95: "‚õàÔ∏è"
  };
  return map[code] || "‚òÅÔ∏è";
}

function cryptoAmpel(change){
  const val = parseFloat(change);
  if (val > 1) return "üü¢";
  if (val < -1) return "üî¥";
  return "üü°";
}

function renderWeather(weather){
  if (!weather) return "";

  const m = weather.trend.morning;
  const a = weather.trend.afternoon;
  const e = weather.trend.evening;

  return `
  <div class="section">
    <h2>Wetter ‚Äì ${weather.location}</h2>

    <div class="weather-main">
      <div style="font-size:32px;">
        ${getWeatherIcon(weather.code)}
      </div>
      <div style="font-size:22px;font-weight:600;">
        ${weather.temp}¬∞C
      </div>
    </div>

    <div class="weather-trend">
      <div class="weather-row">
        <div class="weather-time">09:00</div>
        <div>${getWeatherIcon(m.code)}</div>
        <div>${Math.round(m.temp)}¬∞C</div>
      </div>

      <div class="weather-row">
        <div class="weather-time">15:00</div>
        <div>${getWeatherIcon(a.code)}</div>
        <div>${Math.round(a.temp)}¬∞C</div>
      </div>

      <div class="weather-row">
        <div class="weather-time">21:00</div>
        <div>${getWeatherIcon(e.code)}</div>
        <div>${Math.round(e.temp)}¬∞C</div>
      </div>
    </div>
  </div>
  `;
}

function renderMarkets(markets){
  return `
  <div class="section">
    <h2>M√§rkte</h2>

    <div>
      DAX: ${markets.dax.value} 
      ${cryptoAmpel(markets.dax.change)}
    </div>

    <div>
      EUR/USD: ${markets.eurusd.value}
      ${cryptoAmpel(markets.eurusd.change)}
    </div>

    <br>

    <div>
      Bitcoin: ‚Ç¨${Math.round(markets.bitcoin.price)}
      ${cryptoAmpel(markets.bitcoin.change)}
    </div>

    <div>
      Nexo: ‚Ç¨${markets.nexo.price.toFixed(2)}
      ${cryptoAmpel(markets.nexo.change)}
    </div>
  </div>
  `;
}

async function loadData(){
  try{
    const res = await fetch("/api/daily");
    const data = await res.json();

    document.getElementById("content").innerHTML =
      renderMarkets(data.markets) +
      renderWeather(data.weather);

  } catch(err){
    document.getElementById("content").innerHTML =
      "Fehler beim Laden";
  }
}

loadData();

</script>
</body>
</html>
