<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>GLOBAL SOUL</title>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:linear-gradient(180deg,#081626,#163a57);
  color:#f5f1e6;
}

.container{
  padding:40px;
  max-width:900px;
  margin:auto;
}

h1{
  font-size:48px;
  letter-spacing:3px;
  text-shadow:0 0 25px rgba(255,215,120,0.6);
}

.subtitle{
  opacity:0.85;
}

.meta{
  margin-top:8px;
  opacity:0.8;
}

button{
  margin-top:25px;
  padding:10px 18px;
  border:none;
  background:#e6c27a;
  color:#081626;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.section{
  margin-top:40px;
}

.section h2{
  color:#e6c27a;
  border-bottom:1px solid rgba(255,255,255,0.2);
  padding-bottom:8px;
}

.line{
  display:flex;
  justify-content:space-between;
  margin:10px 0;
}

.ampel{
  width:10px;
  height:10px;
  border-radius:50%;
  display:inline-block;
  margin-left:8px;
}

.green{ background:#2ecc71; }
.red{ background:#e74c3c; }
.yellow{ background:#f1c40f; }

.info{
  color:#f1c40f;
  margin-left:12px;
  text-decoration:none;
  font-weight:bold;
}

.weatherNow{
  font-size:24px;
  margin-top:10px;
}

.trendBlock{
  display:flex;
  justify-content:center;
  gap:80px;
  margin-top:20px;
  text-align:center;
}
</style>
</head>

<body>
<div class="container">

<h1>üåç GLOBAL SOUL</h1>
<div class="subtitle">Claudia‚Äôs Daily Compass</div>
<div class="subtitle"><i>Zwischen Heimat und Horizont.</i></div>
<div id="meta" class="meta"></div>

<button onclick="loadData()">Neue Ausgabe</button>

<div class="section">
<h2>M√§rkte</h2>

<div class="line">
<div>DAX<br><small id="daxDate"></small></div>
<div><span id="daxValue"></span><span class="ampel yellow"></span></div>
</div>

<div class="line">
<div>EUR/USD<br><small id="eurusdDate"></small></div>
<div><span id="eurusdValue"></span><span class="ampel yellow"></span></div>
</div>
</div>

<div class="section">
<h2>Krypto</h2>

<div class="line">
<div>Bitcoin</div>
<div id="btcValue"></div>
</div>

<div class="line">
<div>Nexo</div>
<div id="nexoValue"></div>
</div>
</div>

<div class="section">
<h2>Wetter ‚Äì Ilshofen</h2>

<div id="weatherNow" class="weatherNow"></div>

<div class="trendBlock">
<div>
<div id="mIcon"></div>
<div id="morning"></div>
</div>

<div>
<div id="aIcon"></div>
<div id="afternoon"></div>
</div>

<div>
<div id="eIcon"></div>
<div id="evening"></div>
</div>
</div>
</div>

</div>

<script>
function ampel(change){
  if(change > 1) return '<span class="ampel green"></span>';
  if(change < -1) return '<span class="ampel red"></span>';
  return '<span class="ampel yellow"></span>';
}

function weatherIcon(code){
  if([0].includes(code)) return "‚òÄÔ∏è";
  if([1,2].includes(code)) return "üå§Ô∏è";
  if([3].includes(code)) return "‚òÅÔ∏è";
  if([45,48].includes(code)) return "üå´Ô∏è";
  if([51,53,55,61,63,65].includes(code)) return "üåßÔ∏è";
  if([71,73,75].includes(code)) return "‚ùÑÔ∏è";
  if([95,96,99].includes(code)) return "‚õàÔ∏è";
  return "üå°Ô∏è";
}

function loadData(){
fetch("/api/daily")
.then(res=>res.json())
.then(data=>{

document.getElementById("meta").innerText =
data.timestamp + " ¬∑ v" + data.version;

document.getElementById("daxValue").innerText =
data.markets.dax.value;
document.getElementById("daxDate").innerText =
data.markets.dax.date;

document.getElementById("eurusdValue").innerText =
data.markets.eurusd.value;
document.getElementById("eurusdDate").innerText =
data.markets.eurusd.date;

const btcUSD = data.crypto.bitcoin.price;
const btcEUR = (btcUSD / parseFloat(data.markets.eurusd.value)).toFixed(0);

const nexoUSD = data.crypto.nexo.price;
const nexoEUR = (nexoUSD / parseFloat(data.markets.eurusd.value)).toFixed(3);

document.getElementById("btcValue").innerHTML =
"$" + btcUSD.toLocaleString() +
" (‚Ç¨" + btcEUR + ")" +
ampel(data.crypto.bitcoin.change) +
' <a href="https://www.coingecko.com/en/coins/bitcoin" target="_blank" rel="noopener noreferrer" class="info">Info</a>';

document.getElementById("nexoValue").innerHTML =
"$" + nexoUSD.toFixed(2) +
" (‚Ç¨" + nexoEUR + ")" +
ampel(data.crypto.nexo.change) +
' <a href="https://www.coingecko.com/en/coins/nexo" target="_blank" rel="noopener noreferrer" class="info">Info</a>';

const mainIcon = weatherIcon(data.weather.code);

document.getElementById("weatherNow").innerHTML =
mainIcon + " " + data.weather.temp.toFixed(1) + "¬∞C";

document.getElementById("mIcon").innerHTML = mainIcon;
document.getElementById("aIcon").innerHTML = mainIcon;
document.getElementById("eIcon").innerHTML = mainIcon;

document.getElementById("morning").innerText =
"09:00 " + data.weather.trend.morning + "¬∞C";

document.getElementById("afternoon").innerText =
"15:00 " + data.weather.trend.afternoon + "¬∞C";

document.getElementById("evening").innerText =
"21:00 " + data.weather.trend.evening + "¬∞C";

});
}

loadData();
</script>

</body>
</html>
