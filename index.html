<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>GLOBAL SOUL</title>

  
<style>
body {
  margin: 0;
  font-family: system-ui;
  background: linear-gradient(135deg,#0f1a2b,#16263f);
  color: #e8dcc0;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 40px 20px;
}

h1 {
  font-size: 40px;
  margin-bottom: 6px;
  letter-spacing: 2px;
  font-weight: 600;
  font-family: "Playfair Display", serif;
  color: #f3ead6;
  text-shadow:
    0 0 6px rgba(232,220,192,0.35),
    0 0 18px rgba(232,220,192,0.15);
}

@keyframes glowPulse {
  from {
    text-shadow: 0 0 5px rgba(232,220,192,0.2);
  }
  to {
    text-shadow: 0 0 18px rgba(232,220,192,0.5);
  }
}

.subtitle {
    font-size: 16px;
    opacity: 0.85;
    margin-bottom: 18px;
}

.claim-de {
    font-size: 17px;
    font-weight: 500;
    margin: 0 0 4px 0;
    color: #f3ead6;
}

.claim-en {
    font-size: 13px;
    font-style: italic;
    opacity: 0.55;
    margin: 0 0 22px 0;
}
  
h2 {
  font-size: 22px;
  font-weight: 600;
  margin-top: 50px;
  margin-bottom: 18px;
  color: #f3ead6;
  border-bottom: 1px solid rgba(243,234,214,0.18);
  padding-bottom: 10px;
}

.weather-location {
  font-size: 18px;
  font-weight: 500;
  color: rgba(232,220,192,0.85);
}

.weather-temp-main {
  font-size: 18px;
  font-weight: 500;
  color: #e8dcc0;
  margin: 4px 0;
}

.weather-condition {
  font-size: 13px;
  font-weight: 400;
  color: rgba(232,220,192,0.6);
  margin-bottom: 18px;
}

.trend-grid {
  display: flex;
  gap: 32px;
  margin-top: 6px;
  margin-bottom: 6px;
}

.trend-block {
  text-align: left;
}

.trend-time {
  font-size: 15px;
  font-weight: 500;
  opacity: 0.9;
}

.trend-icon {
  font-size: 26px;
  margin-bottom: 6px;
}

.trend-temp {
  font-size: 18px;
  font-weight: 600;
  color: white;
}

.trend-condition {
  font-size: 14px;
  opacity: 0.75;
}

button {
  margin-top: 25px;
  padding: 12px 20px;
  background: #e8dcc0;
  border: none;
  cursor: pointer;
  font-weight: 600;
  border-radius: 6px;
  color: #0f1a2b;
}
  
.meta-info {
  font-size: 14px;
  font-weight: 400;
  opacity: 0.65;
  letter-spacing: 0.3px;
}

.meta-version {
  font-size: 12px;
  font-style: italic;
  opacity: 0.85;
  margin-left: 6px;
}

.markets-line {
    font-size: 17px;
    font-weight: 500;
    margin: 6px 0;
    color: #e8dcc0;
}

.crypto-line {
    font-size: 18px;
    font-weight: 600;
    margin: 6px 0;
    color: #ffffff;
}
/* --- AMPel --- */
.ampel {
  display: inline-block;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  margin-right: 10px;
  box-shadow: 0 0 6px rgba(255,255,255,0.15);
}

.ampel.green {
  background: #2ecc71;
  box-shadow: 0 0 10px rgba(46,204,113,0.6);
}

.ampel.red {
  background: #e74c3c;
  box-shadow: 0 0 10px rgba(231,76,60,0.6);
}

.ampel.yellow {
  background: #f1c40f;
  box-shadow: 0 0 10px rgba(241,196,15,0.6);
}

  .change-positive {
  color: #2ecc71;
}

.change-negative {
  color: #e74c3c;
}

.change-neutral {
  color: #f1c40f;
}
  .usd {
  opacity: 0.65;
  font-weight: 400;
  font-size: 16px;
}
</style>
</head>

<body>
<div class="container">
  <h1>üåç GLOBAL SOUL</h1>
  <div class="subtitle">Claudia‚Äôs Daily Compass</div>
  <div style="height:12px;"></div>
  <div style="
  font-size:17px;
  font-weight:500;
  color: #f3ead6;
opacity: 0.85;
  margin-bottom:4px;
  letter-spacing: 0.3px;
">
  Zwischen Heimat und Horizont.
</div>

<div class="claim-en">
  between home and horizon
</div>
  
  <div id="metaInfo" class="meta-info"></div>
  <div id="content"></div>
  <button onclick="loadData()">Neue Ausgabe</button>
</div>

<script>
function getIcon(condition, time) {
  if (!condition) return "‚òÄÔ∏è";

  const c = condition.toLowerCase();

  // Abendregel zuerst pr√ºfen
  if (time === "21:00" && c.includes("klar")) return "üåô";

  if (c.includes("klar")) return "‚òÄÔ∏è";
  if (c.includes("bew√∂lkt") || c.includes("cloud")) return "üå§Ô∏è";
  if (c.includes("regen")) return "üåßÔ∏è";
  if (c.includes("schnee")) return "‚ùÑÔ∏è";

  return "‚òÄÔ∏è";
}

function cryptoAmpel(change) {
  const val = parseFloat(change.toString().trim());

  if (val > 1) return '<span class="ampel green"></span>';
  if (val < -1) return '<span class="ampel red"></span>';
  return '<span class="ampel yellow"></span>';
}

async function loadData() {
  const res = await fetch("/api/daily");
  const data = await res.json();

const now = new Date();
const dateString = now.toLocaleDateString("de-DE", {
  weekday: "long",
  day: "2-digit",
  month: "2-digit",
  year: "numeric"
});

const timeString = now.toLocaleTimeString("de-DE", {
  hour: "2-digit",
  minute: "2-digit"
});

document.getElementById("metaInfo").innerHTML =
  `${dateString} ¬∑ ${timeString} Uhr ¬∑ ` +
  `<span class="meta-version">v${data.version}</span>`;
  document.getElementById("content").innerHTML = `
  
  <h2>M√§rkte</h2>
<div class="markets-line">
  DAX: ${data.markets.dax.level} 
  <span style="opacity:0.7">(${data.markets.dax.change}%)</span>
</div>
<div class="markets-line">
  EUR/USD: ${data.markets.eurusd.level} 
  <span style="opacity:0.7">(${data.markets.eurusd.change}%)</span>
</div>

  <h2>Krypto</h2>

<div class="crypto-line">
  ${cryptoAmpel(data.crypto.btc.change)}
  Bitcoin: ${data.crypto.btc.price} ‚Ç¨ 
  <span class="usd">(‚âà ${(data.crypto.btc.price / data.markets.eurusd.level).toFixed(0)} $)</span>
  <span class="${changeClass(data.crypto.btc.change)}">
    (${data.crypto.btc.change}%)
  </span>
</div>

<div class="crypto-line">
  ${cryptoAmpel(data.crypto.nexo.change)}
  NEXO: ${data.crypto.nexo.price} ‚Ç¨ 
  <span class="usd">(‚âà ${(data.crypto.nexo.price / data.markets.eurusd.level).toFixed(2)} $)</span>
  <span class="${changeClass(data.crypto.nexo.change)}">
    (${data.crypto.nexo.change}%)
  </span>
</div>

<h2>Wetter</h2>
<div class="weather-location">
  ${data.weather.location}
</div>
<div class="weather-temp-main">
  ${data.weather.temp}¬∞C
</div>
<div class="weather-condition">
  ${data.weather.condition}
</div>
  <div style="display:flex; gap:70px; margin-left:10px;">
    ${renderTrend(data.weatherTrend.morning)}
    ${renderTrend(data.weatherTrend.afternoon)}
    ${renderTrend(data.weatherTrend.evening)}
  </div>
  `;
}

function renderTrend(t) {

  let conditionText = t.condition;

  if (t.time === "21:00" && t.condition.toLowerCase().includes("klar")) {
    conditionText = "Klar";
  }

  if ((t.time === "09:00" || t.time === "15:00") &&
      t.condition.toLowerCase().includes("klar")) {
    conditionText = "Sonnig";
  }

  return `
    <div style="text-align:left;">
      <div style="font-size:15px; opacity:0.8; margin-bottom:6px;">
        ${t.time}
      </div>
      <div style="font-size:28px; margin-bottom:6px;">
        ${getIcon(t.condition, t.time)}
      </div>
      <div style="font-size:18px; font-weight:600;">
        ${t.temp}¬∞
      </div>
      <div style="font-size:14px; opacity:0.75;">
        ${conditionText}
      </div>
    </div>
  `;
}
loadData();
</script>
  
</body>
</html>
