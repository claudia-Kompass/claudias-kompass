<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>GLOBAL SOUL</title>
<style>

body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:linear-gradient(180deg,#081626,#163a57);
  color:#f5f1e6;
}

.container{
  padding:40px;
  max-width:900px;
  margin:auto;
}

h1{
  font-size:48px;
  letter-spacing:3px;
  text-shadow:0 0 25px rgba(255,215,120,0.5);
}

.subtitle{
  opacity:0.7;
  margin-bottom:30px;
}

.section{
  margin-top:40px;
}

.section h2{
  color:#e6c27a;
  border-bottom:1px solid rgba(255,255,255,0.2);
  padding-bottom:8px;
}

.line{
  display:flex;
  justify-content:space-between;
  margin:10px 0;
}

.right{
  text-align:right;
}

.green{color:#46d17c;}
.red{color:#ff5e5e;}
.yellow{color:#ffd84a;}

.weatherNow{
  font-size:22px;
  margin-top:10px;
}

button{
  margin-top:20px;
  padding:10px 18px;
  border:none;
  background:#e6c27a;
  color:#081626;
  border-radius:6px;
  cursor:pointer;
}

</style>
</head>
<body>

<div class="container">

  <h1>üåç GLOBAL SOUL</h1>
  <div id="meta" class="subtitle"></div>

  <button onclick="loadData()">Neue Ausgabe</button>

  <div id="content"></div>

</div>

<script>
function ampel(change) {
  if (change > 1) return '<span class="ampel green"></span>';
  if (change < -1) return '<span class="ampel red"></span>';
  return '<span class="ampel yellow"></span>';
}

function weatherIcon(code) {
  if ([0].includes(code)) return "‚òÄÔ∏è";
  if ([1,2].includes(code)) return "üå§Ô∏è";
  if ([3].includes(code)) return "‚òÅÔ∏è";
  if ([45,48].includes(code)) return "üå´Ô∏è";
  if ([51,53,55,61,63,65].includes(code)) return "üåßÔ∏è";
  if ([71,73,75].includes(code)) return "‚ùÑÔ∏è";
  if ([95,96,99].includes(code)) return "‚õàÔ∏è";
  return "üå°Ô∏è";
}

fetch("/api/daily")
  .then(res => res.json())
  .then(data => {

    // Header
    document.getElementById("meta").innerText =
      data.timestamp + " ¬∑ v" + data.version;

    // M√§rkte
    document.getElementById("daxValue").innerText =
      data.markets.dax.value;
    document.getElementById("daxDate").innerText =
      data.markets.dax.date;

    document.getElementById("eurusdValue").innerText =
      data.markets.eurusd.value;
    document.getElementById("eurusdDate").innerText =
      data.markets.eurusd.date;

    // Krypto
    const btcUSD = data.crypto.bitcoin.price;
    const btcEUR = (btcUSD / parseFloat(data.markets.eurusd.value)).toFixed(0);

    const nexoUSD = data.crypto.nexo.price;
    const nexoEUR = (nexoUSD / parseFloat(data.markets.eurusd.value)).toFixed(3);

    document.getElementById("btcValue").innerHTML =
      "$" + btcUSD.toLocaleString() +
      " (‚Ç¨" + btcEUR + ") " +
      ampel(data.crypto.bitcoin.change) +
      ' <a href="https://www.coingecko.com/de/coins/bitcoin" target="_blank" class="info">Info</a>';

    document.getElementById("nexoValue").innerHTML =
      "$" + nexoUSD.toFixed(2) +
      " (‚Ç¨" + nexoEUR + ") " +
      ampel(data.crypto.nexo.change) +
      ' <a href="https://www.coingecko.com/de/coins/nexo" target="_blank" class="info">Info</a>';

    // Wetter
    const icon = weatherIcon(data.weather.code);

    document.getElementById("weatherNow").innerHTML =
      icon + " " + data.weather.temp.toFixed(1) + "¬∞C";

    document.getElementById("morning").innerText =
      "09:00  " + data.weather.trend.morning + "¬∞C";

    document.getElementById("afternoon").innerText =
      "15:00  " + data.weather.trend.afternoon + "¬∞C";

    document.getElementById("evening").innerText =
      "21:00  " + data.weather.trend.evening + "¬∞C";
});
</script>

</body>
</html>
