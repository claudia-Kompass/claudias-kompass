<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>GLOBAL SOUL</title>
<style>

body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:linear-gradient(180deg,#081626,#163a57);
  color:#f5f1e6;
}

.container{
  padding:40px;
  max-width:900px;
  margin:auto;
}

h1{
  font-size:48px;
  letter-spacing:3px;
  text-shadow:0 0 25px rgba(255,215,120,0.5);
}

.subtitle{
  opacity:0.7;
  margin-bottom:30px;
}

.section{
  margin-top:40px;
}

.section h2{
  color:#e6c27a;
  border-bottom:1px solid rgba(255,255,255,0.2);
  padding-bottom:8px;
}

.line{
  display:flex;
  justify-content:space-between;
  margin:10px 0;
}

.right{
  text-align:right;
}

.green{color:#46d17c;}
.red{color:#ff5e5e;}
.yellow{color:#ffd84a;}

.weatherNow{
  font-size:22px;
  margin-top:10px;
}

button{
  margin-top:20px;
  padding:10px 18px;
  border:none;
  background:#e6c27a;
  color:#081626;
  border-radius:6px;
  cursor:pointer;
}

</style>
</head>
<body>

<div class="container">

  <h1>üåç GLOBAL SOUL</h1>
  <div id="meta" class="subtitle"></div>

  <button onclick="loadData()">Neue Ausgabe</button>

  <div id="content"></div>

</div>

<script>

function weatherIcon(code){
  if(code===0) return "‚òÄÔ∏è";
  if(code===1 || code===2) return "üå§Ô∏è";
  if(code===3) return "‚òÅÔ∏è";
  if(code>=45 && code<=48) return "üå´Ô∏è";
  if(code>=51 && code<=67) return "üåßÔ∏è";
  if(code>=71 && code<=77) return "‚ùÑÔ∏è";
  if(code>=80 && code<=82) return "üå¶Ô∏è";
  if(code>=95) return "‚õàÔ∏è";
  return "‚òÅÔ∏è";
}

function ampColor(change){
  if(change > 1) return "green";
  if(change < -1) return "red";
  return "yellow";
}

async function loadData(){

  const res = await fetch('/api/daily');
  const data = await res.json();

  document.getElementById("meta").innerHTML =
    data.timestamp + " ¬∑ v" + data.version;

  const eurusd = parseFloat(data.markets.eurusd.value);
  const btcUsd = data.crypto.bitcoin.price;
  const nexoUsd = data.crypto.nexo.price;

  const btcEur = (btcUsd / eurusd).toFixed(0);
  const nexoEur = (nexoUsd / eurusd).toFixed(3);

  const btcColor = ampColor(data.crypto.bitcoin.change);
  const nexoColor = ampColor(data.crypto.nexo.change);

  document.getElementById("content").innerHTML = `

    <div class="section">
      <h2>M√§rkte</h2>

      <div class="line">
        <div>DAX<br><small>${data.markets.dax.date}</small></div>
        <div class="right">
          ${data.markets.dax.value}
          <span class="yellow">‚óè</span>
        </div>
      </div>

      <div class="line">
        <div>EUR/USD<br><small>${data.markets.eurusd.date}</small></div>
        <div class="right">
          ${data.markets.eurusd.value}
          <span class="yellow">‚óè</span>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Krypto</h2>

      <div class="line">
        <div>Bitcoin</div>
        <div class="right">
          $${btcUsd.toLocaleString()} 
          (‚Ç¨${btcEur})
          <span class="${btcColor}">‚óè</span>
        </div>
      </div>

      <div class="line">
        <div>Nexo</div>
        <div class="right">
          $${nexoUsd.toFixed(2)} 
          (‚Ç¨${nexoEur})
          <span class="${nexoColor}">‚óè</span>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Wetter ‚Äì ${data.weather.location}</h2>
      <div class="weatherNow">
        ${weatherIcon(data.weather.code)} 
        ${data.weather.temp.toFixed(1)}¬∞C
      </div>
    </div>

  `;
}

loadData();

</script>

</body>
</html>
